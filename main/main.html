<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="globals.css" />
    <link rel="stylesheet" href="styleguide.css" />
    <link rel="stylesheet" href="main_style.css" />
  </head>
  <body>
    <div class="screen">
      <div class="div">
        <div class="calendar-month">
          <div class="month_group">
            <div class="calendar">
              <div class="month_text" id="month-text">October</div>
              <div class="year_text" id="year-text">2024</div>
              <div class="dates" id="dates"></div>
            </div>
        </div>
        <img class="left_vector" id="prev" src="../icon/left_vector.png"  style="cursor: pointer;" />
        <img class="right_vector" id="next" src="../icon/right_vector.png" style="cursor: pointer;"/>
        </div>
        <div class="view">
          <div class="overlap">
            <div class="overlap-2">
              <div class="sentiment">
                <div class="sentiment_1">
                <div><img class="sentiment_group" src="../icon/sentiment_1.png"/></div>
                </div>
                <div class="sentiment_2">
                  <div><img class="sentiment_group" src="../icon/sentiment_2.png"/></div> 
                </div>
                <div class="sentiment_3">
                    <div><img class="sentiment_group" src="../icon/sentiment_3.png"/></div> 
                </div>
                <div class="sentiment_4">
                    <div><img class="sentiment_group" src="../icon/sentiment_4.png"/></div>
                </div>
                <div class="sentiment_5">
                    <div><img class="sentiment_group" src="../icon/sentiment_5.png"/></div>
                </div>
              </div>
            <div class="count_text_1">0</div>
            <div class="count_text_2">0</div>
            <div class="count_text_3">0</div>
            <div class="count_text_4">0</div>
            <div class="count_text_5">0</div>
            </div>
            <div class="text-wrapper-7">ì´ë‹¬ì˜ ìŒí‘œë“¤ğŸµ</div>
          </div>
        </div>
        <img class="music" src="../icon/music.png" onclick="location.href='../main/main.html'" style="cursor: pointer;"/>
        <div class="calendar-week">
          <div class="days-of-week">
            <div class="div-wrapper-2"><div class="text-wrapper-8">Sun</div></div>
            <div class="div-wrapper-2"><div class="text-wrapper-8">Mon</div></div>
            <div class="div-wrapper-2"><div class="text-wrapper-8">Tue</div></div>
            <div class="div-wrapper-2"><div class="text-wrapper-8">Wed</div></div>
            <div class="div-wrapper-2"><div class="text-wrapper-8">Thu</div></div>
            <div class="div-wrapper-2"><div class="text-wrapper-8">Fri</div></div>
            <div class="div-wrapper-2"><div class="text-wrapper-8">Sat</div></div>
          </div>
        </div>
        <div class="tutorial">
            <div class="tutorial_rectangle" onclick="location.href='../tutorial/tutorial.html'" style="cursor: pointer;">
                <div class="text-wrapper-11">Tutorial ë°”ë¡œ ê°€ê¸°</div>
            </div>
        </div>
      </div>
    </div>
    
    <script>
      const monthNames = ["January", "February", "March", "April", "May", "June",
                          "July", "August", "September", "October", "November", "December"];

      function getParams(){
          var url = window.location.search.replace('?','');
          var params = {};
          var urlArray = url.split('&');
      
          for(var i in urlArray)
          {
            var param = urlArray[i].split('=');
            params[param[0]] = param[1]; 
          }
          return params;
      }

      let params = getParams();

      let currentMonth = new Date().getMonth();  // í˜„ì¬ ì›”ë¡œ ì´ˆê¸°í™” (0-11)
      let currentYear = new Date().getFullYear();

      if(params['year'] !== undefined && params['month'] !== undefined && params['day'] !== undefined) {
        let date = new Date(`${params['year']}-${params['month']}-${params['day']}`);
        currentYear = date.getFullYear();
        currentMonth = date.getMonth();
      }
    
      document.addEventListener("DOMContentLoaded", () => {
        // ì´ì „/ë‹¤ìŒ ë²„íŠ¼ì— ëŒ€í•œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.getElementById("prev").addEventListener("click", () => changeMonth(-1));
        document.getElementById("next").addEventListener("click", () => changeMonth(1));
        
        // ì´ˆê¸° ë‹¬ë ¥ ì„¤ì •
        updateCalendar();
      });
    
      function changeMonth(direction) {
        currentMonth += direction;
    
        // ì›” ë‹¨ìœ„ê°€ ë„˜ì–´ê°€ëŠ” ê²½ìš° ì—°ë„ ë³€ê²½
        if (currentMonth < 0) {
          currentMonth = 11;
          currentYear--;
        } else if (currentMonth > 11) {
          currentMonth = 0;
          currentYear++;
        }
    
        updateCalendar();
      }
    
      function updateCalendar() {
        // ì›”ê³¼ ì—°ë„ ì—…ë°ì´íŠ¸
        document.getElementById("month-text").textContent = monthNames[currentMonth];
        document.getElementById("year-text").textContent = currentYear;
        
        // ë‚ ì§œ ì—…ë°ì´íŠ¸
        generateDates(currentYear, currentMonth);
      }
    
      function generateDates(year, month) {
        const datesContainer = document.getElementById("dates");
        datesContainer.innerHTML = "";  // ê¸°ì¡´ ë‚ ì§œ ì§€ìš°ê¸°
    
        // calendar-date í´ë˜ìŠ¤ë¥¼ ê°€ì§„ div ìƒì„±
        const calendarDateContainer = document.createElement("div");
        calendarDateContainer.classList.add("calendar-date");
    
        // í•´ë‹¹ ì›”ì˜ ì²« ë²ˆì§¸ ë‚ ê³¼ ë§ˆì§€ë§‰ ë‚  êµ¬í•˜ê¸°
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startDay = firstDay.getDay();
        const totalDays = daysInMonth + startDay;
    
        // ì£¼ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ì–´ ë‚ ì§œë¥¼ ì¶œë ¥
        for (let week = 0; week < Math.ceil(totalDays / 7); week++) {
            const weekContainer = document.createElement("div");
            // week ê°’ì— ë”°ë¼ í´ë˜ìŠ¤ ì´ë¦„ì„ ì„¤ì •
            switch (week) {
              case 0:
                  weekContainer.classList.add("first");
                  break;
              case 1:
                  weekContainer.classList.add("second");
                  break;
              case 2:
                  weekContainer.classList.add("third");
                  break;
              case 3:
                  weekContainer.classList.add("fourth");
                  break;
              case 4:
                  weekContainer.classList.add("fifth");
                  break;
              default:
                  break;
                }
            
            // ê° ì£¼ì˜ ë‚ ì§œ ì¶”ê°€
            for (let dayIndex = 0; dayIndex < 7; dayIndex++) {
                const day = week * 7 + dayIndex - startDay + 1;
                const dateCell = document.createElement("div");
    
                // ìš”ì¼ì— ë§ëŠ” í´ë˜ìŠ¤ ì„¤ì •
                let dayClass;
                const dayOfWeek = new Date(year, month, day).getDay();
                switch (dayOfWeek) {
                    case 0: dayClass = "sun"; break;
                    case 1: dayClass = "mon"; break;
                    case 2: dayClass = "tue"; break;
                    case 3: dayClass = "wed"; break;
                    case 4: dayClass = "thu"; break;
                    case 5: dayClass = "fri"; break;
                    case 6: dayClass = "sat"; break;
                }
    
                // ìš”ì¼ í´ë˜ìŠ¤ë¥¼ divì— ì¶”ê°€
                dateCell.classList.add(dayClass);
    
                // overlap-group-3 ë° rectangle êµ¬ì¡° ìƒì„±
                const overlapGroup = document.createElement("div");
                overlapGroup.classList.add("overlap-group-3");
                
                const rectangle = document.createElement("div");
                rectangle.classList.add("rectangle");
    
                // ë‚ ì§œë¥¼ í‘œì‹œí•  í…ìŠ¤íŠ¸ ìš”ì†Œ ì¶”ê°€
                const textWrapper = document.createElement("div");
                textWrapper.classList.add("text-wrapper-9");
                textWrapper.textContent = day >= 1 && day <= daysInMonth ? day : ""; // ìœ íš¨í•œ ë‚ ì§œë§Œ í‘œì‹œ

                if (day >= 1 && day <= daysInMonth) {
                  dateCell.style.cursor = "pointer";
                  // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                  dateCell.addEventListener("click", () => {
                      window.location.href = `../diary/diary.html?year=${year}&month=${month + 1}&day=${day}&dayofweek=${dayOfWeek}`;
                  });
              }
    
                // êµ¬ì¡°ì— ì¶”ê°€
                rectangle.appendChild(textWrapper);
                overlapGroup.appendChild(rectangle);
                dateCell.appendChild(overlapGroup);
                weekContainer.appendChild(dateCell);
            }
    
            // ì£¼ë¥¼ calendar-date divì— ì¶”ê°€
            calendarDateContainer.appendChild(weekContainer);
        }
    
        // ëª¨ë“  ì£¼ë¥¼ ë‹´ì€ calendar-date divë¥¼ ì „ì²´ ë‚ ì§œ ì»¨í…Œì´ë„ˆì— ì¶”ê°€
        datesContainer.appendChild(calendarDateContainer);
    }
    
    </script>  
      
    
  </body>
</html>
